var docCookies={getItem:function(e){return e?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},setItem:function(e,t,o,n,r,s){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var i="";if(o)switch(o.constructor){case Number:i=o===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+o;break;case String:i="; expires="+o;break;case Date:i="; expires="+o.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+i+(r?"; domain="+r:"")+(n?"; path="+n:"")+(s?"; secure":""),!0},removeItem:function(e,t,o){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(o?"; domain="+o:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return!(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,o=0;o<t;o++)e[o]=decodeURIComponent(e[o]);return e}};"undefined"!=typeof module&&void 0!==module.exports&&(module.exports=docCookies);for(var container=document.querySelector(".hotels-list"),activeFilter="filter-all",hotels=[],filteredHotels=[],currentPage=0,PAGE_SIZE=12,filters=document.querySelectorAll(".filters__button"),i=0;i<filters.length;i++)filters[i].onclick=function(e){setActiveFilter(e.target.id)};var scrollTimeout;window.addEventListener("scroll",function(e){clearTimeout(scrollTimeout),scrollTimeout=setTimeout(function(){console.log("scrollevent");var e=document.querySelector("footer").getBoundingClientRect();window.innerHeight;e.bottom-window.innerHeight<=e.height&&currentPage<Math.ceil(filteredHotels.length/PAGE_SIZE)&&renderHotels(filteredHotels,++currentPage)})}),getHotels();function renderHotels(e,t,o){o&&(container.innerHTML="");var n=document.createDocumentFragment(),r=t*PAGE_SIZE,s=r+PAGE_SIZE;e.slice(r,s).forEach(function(e){var t=getElementFromTemplate(e);n.appendChild(t)}),container.appendChild(n)}function setActiveFilter(e){if(activeFilter!==e){switch(document.querySelector("#"+activeFilter).classList.remove("filters--selected"),document.querySelector("#"+e).classList.add("filters--selected"),activeFilter=e,filteredHotels=hotels.slice(0),activeFilter){case"filter-expensive":filteredHotels=filteredHotels.sort(function(e,t){return t.price-e.price})}renderHotels(filteredHotels,0,!0)}}function getHotels(){var e=new XMLHttpRequest;e.open("GET","../data/hotels.json"),e.timeout=1e4,e.onload=function(e){var t=e.target.response,o=JSON.parse(t);renderHotels(hotels=o,0)},e.send()}function getElementFromTemplate(e){var t=document.querySelector("#hotel-template");if("content"in t)var o=t.content.children[0].cloneNode(!0);else o=t.children[0].cloneNode(!0);var n=o.querySelector(".hotel__rating");o.querySelector(".hotel__name").textContent=e.name,o.querySelector(".hotel__price-value").textContent=e.price,e.rating?n.textContent=e.rating:n.style.display="none";var r=new Image,s=setTimeout(function(){r.src="",o.classList.add("hotel--nophoto")},1e4);return r.onload=function(){clearTimeout(s),o.style.backgroundImage="url('"+r.src+"')"},r.onerror=function(){o.classList.add("hotel--nophoto")},r.src=e.preview?e.preview:"",o}var formElement=document.forms.searchform,searchform=document.querySelector(".searchform"),guests=formElement["searchform-guests-number"],rooms=formElement["searchform-guests-rooms"];guests.min=1,guests.max=6;var MAX_GUESTS_PER_ROOM=3;function setMinAndMaxRooms(e,t){e.min=Math.ceil(t/MAX_GUESTS_PER_ROOM),e.max=t}guests.value=docCookies.getItem("guests"),setMinAndMaxRooms(rooms,guests.value),rooms.value=docCookies.getItem("rooms"),guests.onchange=function(){setMinAndMaxRooms(rooms,guests.value)},formElement.onsubmit=function(e){e.preventDefault();var t=+Date.now()+2592e5,o=new Date(t).toUTCString();document.cookie="guests="+guests.value+";expires="+o,document.cookie="rooms="+rooms.value+";expires="+o,formElement.submit()},searchform.addEventListener("mouseover",function(e){e.target.classList.contains("searchform__guests")&&e.target.focus()});